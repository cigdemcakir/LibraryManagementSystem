2023-11-06 16:09:00.666 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 16:09:01.358 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 16:09:01.359 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 16:09:01.360 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 16:09:01.361 +03:00 [INF] Hosting environment: Development
2023-11-06 16:09:01.361 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 16:09:02.214 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 16:09:02.402 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 190.2715ms
2023-11-06 16:09:02.425 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-bundle.js - -
2023-11-06 16:09:02.427 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui.css - -
2023-11-06 16:09:02.448 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-standalone-preset.js - -
2023-11-06 16:09:02.456 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2023-11-06 16:09:02.457 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui.css - - - 200 143943 text/css 30.1228ms
2023-11-06 16:09:02.475 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2023-11-06 16:09:02.479 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-standalone-preset.js - - - 200 339486 text/javascript 31.3793ms
2023-11-06 16:09:02.479 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2023-11-06 16:09:02.480 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-bundle.js - - - 200 1096145 text/javascript 54.8631ms
2023-11-06 16:09:02.746 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 16:09:02.923 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 177.1667ms
2023-11-06 16:11:20.815 +03:00 [INF] Application is shutting down...
2023-11-06 16:15:15.483 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:18:00.651 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:18:53.238 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:19:13.097 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:24:13.779 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:27:15.330 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:27:21.258 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:35:11.013 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:35:22.451 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:36:02.102 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:36:13.158 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:39:50.917 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:39:57.377 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:40:28.919 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:40:35.244 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 16:43:35.054 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 16:43:35.715 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 16:43:35.716 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 16:43:35.717 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 16:43:35.718 +03:00 [INF] Hosting environment: Development
2023-11-06 16:43:35.718 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 16:43:36.328 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 16:43:36.554 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 227.8050ms
2023-11-06 16:43:36.910 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 16:43:37.080 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 169.9305ms
2023-11-06 16:44:44.764 +03:00 [INF] Application is shutting down...
2023-11-06 16:45:08.414 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 16:45:09.119 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 16:45:09.119 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 16:45:09.121 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 16:45:09.121 +03:00 [INF] Hosting environment: Development
2023-11-06 16:45:09.122 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 16:45:09.748 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 16:45:09.925 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 179.6141ms
2023-11-06 16:45:10.165 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 16:45:10.343 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 178.0471ms
2023-11-06 16:48:57.669 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 238
2023-11-06 16:48:57.693 +03:00 [INF] CORS policy execution successful.
2023-11-06 16:48:57.765 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 16:48:57.797 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 16:49:00.447 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 16:49:00.507 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 16:49:00.532 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 2728.023ms
2023-11-06 16:49:00.533 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 16:49:00.560 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 238 - 200 - application/json;+charset=utf-8 2891.5070ms
2023-11-06 16:53:30.585 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 207
2023-11-06 16:53:30.589 +03:00 [INF] CORS policy execution successful.
2023-11-06 16:53:30.592 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 16:53:30.592 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 16:53:30.675 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 16:53:30.677 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 16:53:30.679 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 86.6011ms
2023-11-06 16:53:30.679 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 16:53:30.680 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 207 - 200 - application/json;+charset=utf-8 94.5788ms
2023-11-06 17:09:13.606 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/api/Books application/json -
2023-11-06 17:09:13.626 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 17:09:13.648 +03:00 [INF] Route matched with {action = "GetAllBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllBooksAsync(Application.Features.Books.Queries.GetAll.BookGetAllQuery) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:09:13.672 +03:00 [ERR] Value cannot be null. (Parameter 'request')
System.ArgumentNullException: Value cannot be null. (Parameter 'request')
   at MediatR.Mediator.Send[TResponse](IRequest`1 request, CancellationToken cancellationToken)
   at WebApi.Controllers.BooksController.GetAllBooksAsync(BookGetAllQuery query) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 21
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:09:13.709 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:09:13.719 +03:00 [INF] Executed action WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi) in 70.3291ms
2023-11-06 17:09:13.719 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 17:09:13.720 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/api/Books application/json - - 500 - application/json;+charset=utf-8 114.3311ms
2023-11-06 17:09:29.369 +03:00 [INF] Application is shutting down...
2023-11-06 17:09:40.788 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 17:09:41.646 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 17:09:41.647 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 17:09:41.650 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 17:09:41.650 +03:00 [INF] Hosting environment: Development
2023-11-06 17:09:41.651 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 17:09:44.094 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 17:09:44.405 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 312.9046ms
2023-11-06 17:09:44.607 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-standalone-preset.js - -
2023-11-06 17:09:44.663 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-bundle.js - -
2023-11-06 17:09:44.712 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2023-11-06 17:09:44.748 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-standalone-preset.js - - - 200 339486 text/javascript 140.8498ms
2023-11-06 17:09:44.811 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 17:09:44.818 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2023-11-06 17:09:44.826 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-bundle.js - - - 200 1096145 text/javascript 162.7863ms
2023-11-06 17:09:45.076 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 264.7291ms
2023-11-06 17:09:54.885 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/api/Books application/json -
2023-11-06 17:09:55.039 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 17:09:55.075 +03:00 [INF] Route matched with {action = "GetAllBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllBooksAsync(Application.Features.Books.Queries.GetAll.BookGetAllQuery) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:12:53.936 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 17:12:54.771 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 17:12:54.771 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 17:12:54.774 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 17:12:54.774 +03:00 [INF] Hosting environment: Development
2023-11-06 17:12:54.774 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 17:13:00.589 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 17:13:00.810 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 222.9769ms
2023-11-06 17:13:01.042 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 17:13:01.221 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 178.4354ms
2023-11-06 17:13:07.264 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/api/Books - -
2023-11-06 17:13:07.427 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 17:13:07.456 +03:00 [INF] Route matched with {action = "GetAllBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllBooksAsync() on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:13:15.066 +03:00 [INF] Executed DbCommand (109ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[Title], [b].[Author], [b].[ImageUrl], CAST(1 AS bit) AS [IsAvailable], (
    SELECT TOP(1) [l0].[LoanedOutTo]
    FROM [Loans] AS [l0]
    WHERE 0 = 1) AS [LoanedOutTo], (
    SELECT TOP(1) [l1].[DueDate]
    FROM [Loans] AS [l1]
    WHERE 0 = 1) AS [DueDate]
FROM [Books] AS [b]
ORDER BY [b].[Title]
2023-11-06 17:13:31.026 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.Features.Books.Queries.GetAll.BookGetAllDto, SanctionScanner.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-06 17:13:31.111 +03:00 [INF] Executed action WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi) in 23620.7197ms
2023-11-06 17:13:31.113 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 17:13:31.154 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/api/Books - - - 200 - application/json;+charset=utf-8 23866.0750ms
2023-11-06 17:13:49.685 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 17:13:50.366 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 17:13:50.367 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 17:13:50.368 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 17:13:50.368 +03:00 [INF] Hosting environment: Development
2023-11-06 17:13:50.369 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 17:13:51.077 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 17:13:51.255 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 179.7342ms
2023-11-06 17:13:51.466 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 17:13:51.611 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 144.9261ms
2023-11-06 17:14:25.648 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/3fa85f64-5717-4562-b3fc-2c963f66afa6/return application/json 54
2023-11-06 17:14:25.664 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:14:25.710 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 17:14:25.742 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:14:28.095 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE 0 = 1
2023-11-06 17:14:28.144 +03:00 [ERR] Loan record not found.
System.Exception: Loan record not found.
   at Application.Features.Books.Commands.ReturnBook.BookReturnCommandHandler.Handle(BookReturnCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/ReturnBook/BookReturnCommandHandler.cs:line 27
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Return(BookReturnCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:14:28.168 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:14:28.182 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 2433.7556ms
2023-11-06 17:14:28.184 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 17:14:28.211 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/3fa85f64-5717-4562-b3fc-2c963f66afa6/return application/json 54 - 500 - application/json;+charset=utf-8 2562.2246ms
2023-11-06 17:14:34.402 +03:00 [INF] Application is shutting down...
2023-11-06 17:15:13.880 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 17:15:14.627 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 17:15:14.628 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 17:15:14.630 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 17:15:14.630 +03:00 [INF] Hosting environment: Development
2023-11-06 17:15:14.630 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 17:15:18.346 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 17:15:18.562 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 218.3653ms
2023-11-06 17:15:18.781 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 17:15:18.956 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 175.6175ms
2023-11-06 17:15:46.966 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/return application/json 54
2023-11-06 17:15:46.998 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:15:47.144 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 17:15:47.179 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:16:02.495 +03:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE 0 = 1
2023-11-06 17:16:15.072 +03:00 [ERR] Loan record not found.
System.Exception: Loan record not found.
   at Application.Features.Books.Commands.ReturnBook.BookReturnCommandHandler.Handle(BookReturnCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/ReturnBook/BookReturnCommandHandler.cs:line 27
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Return(BookReturnCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:16:15.087 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:16:15.109 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 27918.8097ms
2023-11-06 17:16:15.113 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 17:16:15.168 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/return application/json 54 - 500 - application/json;+charset=utf-8 28200.7885ms
2023-11-06 17:17:10.563 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/checkout application/json 124
2023-11-06 17:17:10.566 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:17:10.568 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:17:10.573 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:17:10.783 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:17:10.785 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 211.6475ms
2023-11-06 17:17:10.785 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:17:10.785 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/checkout application/json 124 - 400 - application/json;+charset=utf-8 227.9319ms
2023-11-06 17:17:28.270 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/checkout application/json 124
2023-11-06 17:17:28.271 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:17:28.274 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:17:28.274 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:17:28.597 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 17:17:29.240 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 17:17:29.291 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Persistence.Contexts.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:016a5baf-38ac-4325-b169-287d63e62211
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:016a5baf-38ac-4325-b169-287d63e62211
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 17:17:29.471 +03:00 [ERR] An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:016a5baf-38ac-4325-b169-287d63e62211
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 45
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:17:29.475 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:17:29.475 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 1200.7643ms
2023-11-06 17:17:29.476 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:17:29.476 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/checkout application/json 124 - 500 - application/json;+charset=utf-8 1205.6849ms
2023-11-06 17:17:48.038 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/checkout application/json 122
2023-11-06 17:17:48.038 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:17:48.038 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:17:48.039 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:17:48.120 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 17:17:48.132 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 17:17:48.137 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Persistence.Contexts.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:016a5baf-38ac-4325-b169-287d63e62211
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:016a5baf-38ac-4325-b169-287d63e62211
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 17:17:48.289 +03:00 [ERR] An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:016a5baf-38ac-4325-b169-287d63e62211
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 45
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:17:48.294 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:17:48.294 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 255.0435ms
2023-11-06 17:17:48.294 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:17:48.295 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/F65C8219-BCCC-4D7C-9DD9-08DBDECF2108/checkout application/json 122 - 500 - application/json;+charset=utf-8 256.7117ms
2023-11-06 17:18:04.519 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 17:18:05.384 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 17:18:05.385 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 17:18:05.387 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 17:18:05.387 +03:00 [INF] Hosting environment: Development
2023-11-06 17:18:05.387 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 17:18:09.014 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 17:18:09.265 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 253.5533ms
2023-11-06 17:18:09.499 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 17:18:09.714 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 214.8839ms
2023-11-06 17:19:11.187 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122
2023-11-06 17:19:11.217 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:19:11.361 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:19:11.401 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:19:14.985 +03:00 [INF] Executed DbCommand (112ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 17:19:15.482 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 17:19:15.552 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Persistence.Contexts.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f01452a2-cab1-4e79-a80b-d982f2834133
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f01452a2-cab1-4e79-a80b-d982f2834133
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 17:19:15.756 +03:00 [ERR] An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f01452a2-cab1-4e79-a80b-d982f2834133
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 45
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:19:15.789 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:19:15.814 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 4391.58ms
2023-11-06 17:19:15.818 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:19:15.870 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122 - 500 - application/json;+charset=utf-8 4683.8629ms
2023-11-06 17:19:41.991 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 17:19:42.786 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 17:19:42.787 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 17:19:42.789 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 17:19:42.789 +03:00 [INF] Hosting environment: Development
2023-11-06 17:19:42.789 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 17:19:46.578 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 17:19:46.822 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 246.3279ms
2023-11-06 17:19:47.043 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 17:19:47.218 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 175.6931ms
2023-11-06 17:20:22.430 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122
2023-11-06 17:20:22.472 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:20:22.617 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:20:22.654 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:21:10.725 +03:00 [INF] Executed DbCommand (107ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 17:21:11.229 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 17:21:11.313 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Persistence.Contexts.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 17:21:35.067 +03:00 [ERR] An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 45
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:21:35.087 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:21:35.125 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 72455.7308ms
2023-11-06 17:21:35.128 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:21:35.183 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122 - 500 - application/json;+charset=utf-8 72751.2119ms
2023-11-06 17:21:58.836 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122
2023-11-06 17:21:58.861 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:21:58.863 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:21:58.864 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:22:22.187 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 17:22:59.360 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 17:22:59.398 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Persistence.Contexts.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 17:23:18.955 +03:00 [ERR] An error occurred while saving the entity changes. See the inner exception for details.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 45
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 17:23:18.959 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 17:23:18.960 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 80095.2256ms
2023-11-06 17:23:18.961 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:23:18.961 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122 - 500 - application/json;+charset=utf-8 80124.3662ms
2023-11-06 17:23:25.376 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122
2023-11-06 17:23:25.377 +03:00 [INF] CORS policy execution successful.
2023-11-06 17:23:25.379 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 17:23:25.379 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 17:23:34.037 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 17:23:52.119 +03:00 [INF] Executed DbCommand (120ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 17:23:52.156 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Persistence.Contexts.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'ReturnedDate', table 'cigdem_sanction_scanner.dbo.Loans'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreResults(Boolean& moreResults)
   at Microsoft.Data.SqlClient.SqlDataReader.TryNextResult(Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.NextResultAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:aa0e7143-b92c-4de8-b248-df79f0af0cc0
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2023-11-06 18:25:05.169 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 18:25:11.789 +03:00 [FTL] SanctionScanner.Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Program.cs:line 162
2023-11-06 18:25:58.445 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 18:25:59.292 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 18:25:59.293 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 18:25:59.295 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:25:59.295 +03:00 [INF] Hosting environment: Development
2023-11-06 18:25:59.295 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 18:26:02.830 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 18:26:03.084 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 255.9997ms
2023-11-06 18:26:03.119 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-standalone-preset.js - -
2023-11-06 18:26:03.123 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-bundle.js - -
2023-11-06 18:26:03.162 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2023-11-06 18:26:03.163 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-standalone-preset.js - - - 200 339486 text/javascript 43.3241ms
2023-11-06 18:26:03.167 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2023-11-06 18:26:03.167 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/swagger-ui-bundle.js - - - 200 1096145 text/javascript 43.9776ms
2023-11-06 18:26:03.451 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 18:26:03.669 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 218.2916ms
2023-11-06 18:26:39.874 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122
2023-11-06 18:26:39.907 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:26:40.058 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 18:26:40.100 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:26:57.835 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 18:27:18.119 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2023-11-06 18:28:02.862 +03:00 [ERR] Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Buffer.Memmove(Byte& dest, Byte& src, UIntPtr len)
   at System.Runtime.CompilerServices.DefaultInterpolatedStringHandler.AppendStringDirect(String value)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 45
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 18:28:02.876 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 18:28:02.900 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 82786.4427ms
2023-11-06 18:28:02.903 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 18:28:02.952 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122 - 500 - application/json;+charset=utf-8 83076.1476ms
2023-11-06 18:35:52.294 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122
2023-11-06 18:35:52.300 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:35:52.305 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 18:35:52.307 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:35:59.540 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 18:36:03.318 +03:00 [ERR] Book is not available for checkout.
System.InvalidOperationException: Book is not available for checkout.
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 30
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 18:36:03.320 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 18:36:03.321 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 11013.7318ms
2023-11-06 18:36:03.322 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 18:36:03.322 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122 - 500 - application/json;+charset=utf-8 11028.8549ms
2023-11-06 18:36:18.623 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122
2023-11-06 18:36:18.624 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:36:18.625 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 18:36:18.626 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:36:27.868 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 18:36:48.911 +03:00 [ERR] Book is not available for checkout.
System.InvalidOperationException: Book is not available for checkout.
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 30
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 18:36:48.913 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 18:36:48.913 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 30286.3642ms
2023-11-06 18:36:48.913 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 18:36:48.913 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/checkout application/json 122 - 500 - application/json;+charset=utf-8 30290.0286ms
2023-11-06 18:37:25.456 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/return application/json 54
2023-11-06 18:37:25.470 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:37:25.471 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 18:37:25.477 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:37:25.595 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 18:37:25.714 +03:00 [ERR] Loan record not found.
System.Exception: Loan record not found.
   at Application.Features.Books.Commands.ReturnBook.BookReturnCommandHandler.Handle(BookReturnCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/ReturnBook/BookReturnCommandHandler.cs:line 27
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Return(BookReturnCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 18:37:25.715 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 18:37:25.716 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 238.5653ms
2023-11-06 18:37:25.716 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 18:37:25.716 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/581B780D-FE1F-4620-9DDA-08DBDECF2108/return application/json 54 - 500 - application/json;+charset=utf-8 259.7989ms
2023-11-06 18:39:36.682 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/api/Books - -
2023-11-06 18:39:36.686 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 18:39:36.696 +03:00 [INF] Route matched with {action = "GetAllBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllBooksAsync() on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:39:36.886 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[Title], [b].[Author], [b].[ImageUrl], CASE
    WHEN NOT EXISTS (
        SELECT 1
        FROM [Loans] AS [l]
        WHERE [b].[Id] = [l].[BookId] AND ([l].[ReturnedDate] IS NULL)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END AS [IsAvailable], (
    SELECT TOP(1) [l0].[LoanedOutTo]
    FROM [Loans] AS [l0]
    WHERE [b].[Id] = [l0].[BookId] AND ([l0].[ReturnedDate] IS NULL)) AS [LoanedOutTo], (
    SELECT TOP(1) [l1].[DueDate]
    FROM [Loans] AS [l1]
    WHERE [b].[Id] = [l1].[BookId] AND ([l1].[ReturnedDate] IS NULL)) AS [DueDate]
FROM [Books] AS [b]
ORDER BY [b].[Title]
2023-11-06 18:39:36.896 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.Features.Books.Queries.GetAll.BookGetAllDto, SanctionScanner.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-06 18:39:36.948 +03:00 [INF] Executed action WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi) in 251.7552ms
2023-11-06 18:39:36.949 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 18:39:36.949 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/api/Books - - - 200 - application/json;+charset=utf-8 267.0253ms
2023-11-06 18:41:23.389 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 18:41:24.263 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 18:41:24.264 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 18:41:24.266 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 18:41:24.266 +03:00 [INF] Hosting environment: Development
2023-11-06 18:41:24.266 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 18:41:27.686 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 18:41:27.922 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 237.3812ms
2023-11-06 18:41:28.287 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 18:41:28.506 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 219.0439ms
2023-11-06 18:43:07.702 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 223
2023-11-06 18:43:07.722 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:43:07.914 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:43:07.951 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:43:11.549 +03:00 [INF] Executed DbCommand (104ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 18:43:11.630 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 18:43:11.668 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 3707.8663ms
2023-11-06 18:43:11.671 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:43:11.714 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 223 - 200 - application/json;+charset=utf-8 4012.5031ms
2023-11-06 18:46:00.100 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 226
2023-11-06 18:46:00.115 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:46:00.117 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:46:00.118 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:46:00.219 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 18:46:00.221 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 18:46:00.222 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 103.4634ms
2023-11-06 18:46:00.222 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:46:00.223 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 226 - 200 - application/json;+charset=utf-8 122.8263ms
2023-11-06 18:48:52.662 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 213
2023-11-06 18:48:52.666 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:48:52.669 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:48:52.669 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:48:52.699 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 18:48:52.699 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 18:48:52.700 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 30.427ms
2023-11-06 18:48:52.700 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:48:52.701 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 213 - 200 - application/json;+charset=utf-8 38.7076ms
2023-11-06 18:50:56.964 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 169
2023-11-06 18:50:56.970 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:50:56.971 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:50:56.971 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:50:57.013 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 18:50:57.014 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 18:50:57.015 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 42.4601ms
2023-11-06 18:50:57.015 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:50:57.015 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 169 - 200 - application/json;+charset=utf-8 51.0496ms
2023-11-06 18:52:10.276 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 201
2023-11-06 18:52:10.276 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:52:10.276 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:52:10.277 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:52:10.305 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 18:52:10.306 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 18:52:10.309 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 31.7952ms
2023-11-06 18:52:10.310 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:52:10.310 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 201 - 200 - application/json;+charset=utf-8 34.4105ms
2023-11-06 18:53:40.770 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7109/api/Books application/json 189
2023-11-06 18:53:40.771 +03:00 [INF] CORS policy execution successful.
2023-11-06 18:53:40.771 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:53:40.786 +03:00 [INF] Route matched with {action = "AddBook", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddBookAsync(Application.Features.Books.Commands.AddBook.BookAddCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 18:53:40.796 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = Int32), @p7='?' (Size = 500), @p8='?' (DbType = Boolean), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Books] ([Id], [Author], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [Genre], [ImageUrl], [IsAvailable], [IsDeleted], [ModifiedByUserId], [ModifiedOn], [Title])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 18:53:40.797 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 18:53:40.797 +03:00 [INF] Executed action WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi) in 11.5966ms
2023-11-06 18:53:40.798 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.AddBookAsync (SanctionScanner.WebApi)'
2023-11-06 18:53:40.804 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7109/api/Books application/json 189 - 200 - application/json;+charset=utf-8 34.7002ms
2023-11-06 19:00:08.563 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/api/Books - -
2023-11-06 19:00:08.564 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 19:00:08.572 +03:00 [INF] Route matched with {action = "GetAllBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllBooksAsync() on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:00:09.446 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[Id], [b].[Title], [b].[Author], [b].[ImageUrl], CASE
    WHEN NOT EXISTS (
        SELECT 1
        FROM [Loans] AS [l]
        WHERE [b].[Id] = [l].[BookId] AND ([l].[ReturnedDate] IS NULL)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END AS [IsAvailable], (
    SELECT TOP(1) [l0].[LoanedOutTo]
    FROM [Loans] AS [l0]
    WHERE [b].[Id] = [l0].[BookId] AND ([l0].[ReturnedDate] IS NULL)) AS [LoanedOutTo], (
    SELECT TOP(1) [l1].[DueDate]
    FROM [Loans] AS [l1]
    WHERE [b].[Id] = [l1].[BookId] AND ([l1].[ReturnedDate] IS NULL)) AS [DueDate]
FROM [Books] AS [b]
ORDER BY [b].[Title]
2023-11-06 19:00:09.485 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.Features.Books.Queries.GetAll.BookGetAllDto, SanctionScanner.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2023-11-06 19:00:09.532 +03:00 [INF] Executed action WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi) in 959.9195ms
2023-11-06 19:00:09.532 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.GetAllBooksAsync (SanctionScanner.WebApi)'
2023-11-06 19:00:09.533 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/api/Books - - - 200 - application/json;+charset=utf-8 969.6056ms
2023-11-06 19:02:04.407 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122
2023-11-06 19:02:04.423 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:02:04.423 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:02:04.432 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:02:15.450 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:02:22.892 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2023-11-06 19:02:27.129 +03:00 [ERR] Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Buffer.Memmove(Byte& dest, Byte& src, UIntPtr len)
   at System.Runtime.CompilerServices.DefaultInterpolatedStringHandler.AppendStringDirect(String value)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 45
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 19:02:27.137 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 19:02:27.142 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 22709.7194ms
2023-11-06 19:02:27.143 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:02:27.143 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122 - 500 - application/json;+charset=utf-8 22734.9290ms
2023-11-06 19:04:26.179 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:04:27.026 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:04:27.027 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:04:27.028 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:04:27.029 +03:00 [INF] Hosting environment: Development
2023-11-06 19:04:27.029 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:04:30.462 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:04:30.711 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 250.6324ms
2023-11-06 19:04:30.950 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:04:31.157 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 206.9753ms
2023-11-06 19:05:03.526 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122
2023-11-06 19:05:03.554 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:05:03.688 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:05:03.722 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:05:14.809 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:06:09.057 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 19:06:40.914 +03:00 [ERR] Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Buffer.Memmove(Byte& dest, Byte& src, UIntPtr len)
   at System.Runtime.CompilerServices.DefaultInterpolatedStringHandler.AppendStringDirect(String value)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 47
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 19:06:40.930 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 19:06:40.954 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 97227.4245ms
2023-11-06 19:06:40.957 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:06:41.021 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122 - 500 - application/json;+charset=utf-8 97501.8570ms
2023-11-06 19:10:39.827 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122
2023-11-06 19:10:39.843 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:10:39.846 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:10:39.847 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:10:56.879 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:11:13.660 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:11:14.438 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:11:14.438 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:11:14.440 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:11:14.440 +03:00 [INF] Hosting environment: Development
2023-11-06 19:11:14.441 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:11:17.836 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:11:18.072 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 237.6671ms
2023-11-06 19:11:18.332 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:11:18.562 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 229.0193ms
2023-11-06 19:11:55.234 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122
2023-11-06 19:11:55.263 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:11:55.400 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:11:55.438 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:12:12.159 +03:00 [INF] Executed DbCommand (99ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:14:03.592 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:14:04.321 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:14:04.322 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:14:04.324 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:14:04.324 +03:00 [INF] Hosting environment: Development
2023-11-06 19:14:04.324 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:14:08.041 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:14:08.272 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 232.8491ms
2023-11-06 19:14:08.513 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:14:08.718 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 205.1820ms
2023-11-06 19:14:47.895 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122
2023-11-06 19:14:47.942 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:14:48.093 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:14:48.138 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:14:58.752 +03:00 [INF] Executed DbCommand (107ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:15:05.100 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 19:23:52.232 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:23:53.033 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:23:53.034 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:23:53.035 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:23:53.036 +03:00 [INF] Hosting environment: Development
2023-11-06 19:23:53.036 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:23:56.523 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:23:56.797 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 276.1248ms
2023-11-06 19:23:57.052 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:23:57.287 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 234.5503ms
2023-11-06 19:24:35.060 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122
2023-11-06 19:24:35.090 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:24:35.239 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:24:35.275 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:24:44.714 +03:00 [INF] Executed DbCommand (106ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:24:50.236 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 19:26:34.986 +03:00 [ERR] Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Buffer.Memmove(Byte& dest, Byte& src, UIntPtr len)
   at System.Runtime.CompilerServices.DefaultInterpolatedStringHandler.AppendStringDirect(String value)
   at Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommandHandler.Handle(BookCheckoutCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/CheckoutBook/BookCheckoutCommandHandler.cs:line 47
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Checkout(Guid id, BookCheckoutCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 19:29:40.872 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:29:41.756 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:29:41.756 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:29:41.758 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:29:41.758 +03:00 [INF] Hosting environment: Development
2023-11-06 19:29:41.758 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:29:44.927 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:29:45.149 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 223.5623ms
2023-11-06 19:29:45.387 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:29:45.607 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 219.7852ms
2023-11-06 19:30:14.088 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 122
2023-11-06 19:30:14.119 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:30:14.268 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:30:14.306 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:30:23.972 +03:00 [INF] Executed DbCommand (110ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:30:29.959 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = DateTimeOffset), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTimeOffset), @p9='?' (Size = 200), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 19:35:28.595 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:35:29.370 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:35:29.371 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:35:29.373 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:35:29.373 +03:00 [INF] Hosting environment: Development
2023-11-06 19:35:29.374 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:35:32.880 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:35:33.109 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 230.6336ms
2023-11-06 19:35:33.356 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:35:33.567 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 210.3472ms
2023-11-06 19:36:07.567 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/checkout?id=A3F71772-A295-4EE6-DC7A-08DBDEDF146B application/json 122
2023-11-06 19:36:07.593 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:36:07.739 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:36:07.775 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:36:16.999 +03:00 [INF] Executed DbCommand (101ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:36:31.276 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = DateTimeOffset), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (DbType = DateTimeOffset), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTimeOffset), @p9='?' (Size = 200), @p10='?' (Size = 4000), @p11='?' (DbType = DateTimeOffset), @p12='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2023-11-06 19:36:47.995 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 19:36:48.021 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 40235.1642ms
2023-11-06 19:36:48.024 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:36:48.072 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/checkout?id=A3F71772-A295-4EE6-DC7A-08DBDEDF146B application/json 122 - 200 - application/json;+charset=utf-8 40503.6399ms
2023-11-06 19:49:21.643 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:49:22.443 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:49:22.444 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:49:22.445 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:49:22.445 +03:00 [INF] Hosting environment: Development
2023-11-06 19:49:22.446 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:49:25.984 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:49:26.234 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 252.7138ms
2023-11-06 19:49:26.486 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:49:26.715 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 228.6720ms
2023-11-06 19:49:58.807 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 119
2023-11-06 19:49:58.837 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:49:58.987 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:49:59.022 +03:00 [INF] Route matched with {action = "Checkout", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(System.Guid, Application.Features.Books.Commands.CheckoutBook.BookCheckoutCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:50:05.950 +03:00 [INF] Executed DbCommand (106ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[Author], [t].[CreatedByUserId], [t].[CreatedOn], [t].[DeletedByUserId], [t].[DeletedOn], [t].[Genre], [t].[ImageUrl], [t].[IsAvailable], [t].[IsDeleted], [t].[ModifiedByUserId], [t].[ModifiedOn], [t].[Title], [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM (
    SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[Id] = @__request_BookId_0
) AS [t]
LEFT JOIN [Loans] AS [l] ON [t].[Id] = [l].[BookId]
ORDER BY [t].[Id]
2023-11-06 19:50:06.449 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 4000), @p7='?' (DbType = DateTimeOffset), @p8='?' (DbType = DateTimeOffset), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 200), @p12='?' (Size = 4000), @p13='?' (DbType = DateTimeOffset), @p14='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Loans] ([Id], [BookId], [CreatedByUserId], [CreatedOn], [DeletedByUserId], [DeletedOn], [DueDate], [IsDeleted], [LoanDate], [LoanedOutTo], [ModifiedByUserId], [ModifiedOn], [ReturnedDate])
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2023-11-06 19:50:10.473 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 19:50:10.500 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi) in 11467.1788ms
2023-11-06 19:50:10.504 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Checkout (SanctionScanner.WebApi)'
2023-11-06 19:50:10.562 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/checkout application/json 119 - 200 - application/json;+charset=utf-8 11755.3182ms
2023-11-06 19:51:26.334 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 19:51:31.167 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:51:31.326 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 19:51:31.334 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:51:31.470 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 19:51:43.254 +03:00 [ERR] Sequence contains more than one element.
System.InvalidOperationException: Sequence contains more than one element.
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Application.Features.Books.Commands.ReturnBook.BookReturnCommandHandler.Handle(BookReturnCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/ReturnBook/BookReturnCommandHandler.cs:line 21
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Return(BookReturnCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 19:51:59.916 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 19:52:04.919 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 33584.4056ms
2023-11-06 19:52:04.920 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 19:52:04.921 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54 - 500 - application/json;+charset=utf-8 38590.9046ms
2023-11-06 19:53:25.873 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 19:53:27.922 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:53:30.949 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 19:53:32.471 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:53:41.176 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 19:55:56.664 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 19:55:57.404 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 19:55:57.404 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 19:55:57.406 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 19:55:57.406 +03:00 [INF] Hosting environment: Development
2023-11-06 19:55:57.407 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 19:56:01.186 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 19:56:01.434 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 250.8534ms
2023-11-06 19:56:01.674 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 19:56:01.879 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 205.5893ms
2023-11-06 19:56:35.507 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 19:56:35.537 +03:00 [INF] CORS policy execution successful.
2023-11-06 19:56:35.678 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 19:56:35.712 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 19:56:43.269 +03:00 [INF] Executed DbCommand (104ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 19:57:02.829 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Loans] SET [ReturnedDate] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2023-11-06 19:57:43.976 +03:00 [ERR] Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Buffer.Memmove(Byte& dest, Byte& src, UIntPtr len)
   at System.Runtime.CompilerServices.DefaultInterpolatedStringHandler.AppendStringDirect(String value)
   at Application.Features.Books.Commands.ReturnBook.BookReturnCommandHandler.Handle(BookReturnCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/ReturnBook/BookReturnCommandHandler.cs:line 34
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Return(BookReturnCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 19:57:43.992 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 19:57:44.015 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 68290.7997ms
2023-11-06 19:57:44.019 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 19:57:44.081 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54 - 500 - application/json;+charset=utf-8 68573.3889ms
2023-11-06 20:23:12.841 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 20:23:14.023 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 20:23:14.023 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 20:23:14.025 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 20:23:14.025 +03:00 [INF] Hosting environment: Development
2023-11-06 20:23:14.025 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 20:23:17.012 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 20:23:17.280 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 270.3635ms
2023-11-06 20:23:17.534 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 20:23:17.749 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 215.7832ms
2023-11-06 20:23:40.213 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 20:23:40.243 +03:00 [INF] CORS policy execution successful.
2023-11-06 20:23:40.390 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:23:40.426 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 20:23:43.679 +03:00 [INF] Executed DbCommand (110ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 20:24:02.431 +03:00 [INF] Executed DbCommand (136ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
FROM [Books] AS [b]
WHERE [b].[Id] = @__request_BookId_0
2023-11-06 20:24:12.267 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p3='?' (DbType = Guid), @p2='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
UPDATE [Loans] SET [ReturnedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2023-11-06 20:25:16.049 +03:00 [ERR] Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Buffer.Memmove(Byte& dest, Byte& src, UIntPtr len)
   at System.Runtime.CompilerServices.DefaultInterpolatedStringHandler.AppendStringDirect(String value)
   at Application.Features.Books.Commands.ReturnBook.BookReturnCommandHandler.Handle(BookReturnCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/ReturnBook/BookReturnCommandHandler.cs:line 44
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Return(BookReturnCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 20:25:16.067 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 20:25:16.093 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 95654.2548ms
2023-11-06 20:25:16.097 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:25:16.143 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54 - 500 - application/json;+charset=utf-8 95931.5091ms
2023-11-06 20:25:23.916 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 20:25:23.920 +03:00 [INF] CORS policy execution successful.
2023-11-06 20:25:23.922 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:25:23.923 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 20:25:23.992 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 20:25:28.374 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
FROM [Books] AS [b]
WHERE [b].[Id] = @__request_BookId_0
2023-11-06 20:25:31.662 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p3='?' (DbType = Guid), @p2='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
UPDATE [Loans] SET [ReturnedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2023-11-06 20:25:57.994 +03:00 [ERR] Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Buffer.Memmove(Byte& dest, Byte& src, UIntPtr len)
   at System.Runtime.CompilerServices.DefaultInterpolatedStringHandler.AppendStringDirect(String value)
   at Application.Features.Books.Commands.ReturnBook.BookReturnCommandHandler.Handle(BookReturnCommand request, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Features/Books/Commands/ReturnBook/BookReturnCommandHandler.cs:line 44
   at Application.Common.Behaviours.ValidationBehaviour`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.Application/Common/Behaviours/ValidationBehaviour.cs:line 35
   at WebApi.Controllers.BooksController.Return(BookReturnCommand command) in /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi/Controllers/BooksController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextExceptionFilterAsync>g__Awaited|26_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
2023-11-06 20:25:57.997 +03:00 [INF] Executing ObjectResult, writing value of type 'Application.Common.Models.Errors.ApiErrorDto'.
2023-11-06 20:25:57.998 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 34074.0827ms
2023-11-06 20:25:57.998 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:25:57.999 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54 - 500 - application/json;+charset=utf-8 34081.9368ms
2023-11-06 20:26:24.466 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 20:26:24.488 +03:00 [INF] CORS policy execution successful.
2023-11-06 20:26:24.489 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:26:24.490 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 20:26:24.681 +03:00 [INF] Executed DbCommand (143ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 20:26:29.012 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
FROM [Books] AS [b]
WHERE [b].[Id] = @__request_BookId_0
2023-11-06 20:26:31.273 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Loans] SET [ReturnedDate] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2023-11-06 20:28:30.797 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 20:28:31.560 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 20:28:31.561 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 20:28:31.563 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 20:28:31.563 +03:00 [INF] Hosting environment: Development
2023-11-06 20:28:31.563 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 20:28:35.200 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 20:28:35.427 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 229.2173ms
2023-11-06 20:28:35.689 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 20:28:35.913 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 223.5920ms
2023-11-06 20:29:06.660 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 20:29:06.690 +03:00 [INF] CORS policy execution successful.
2023-11-06 20:29:06.834 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:29:06.887 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 20:29:10.135 +03:00 [INF] Executed DbCommand (106ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 20:29:10.321 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
FROM [Books] AS [b]
WHERE [b].[Id] = @__request_BookId_0
2023-11-06 20:29:13.422 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p3='?' (DbType = Guid), @p2='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
UPDATE [Loans] SET [ReturnedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2023-11-06 20:29:21.850 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 20:29:21.875 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 14977.7457ms
2023-11-06 20:29:21.877 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:29:21.920 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54 - 200 - application/json;+charset=utf-8 15259.8156ms
2023-11-06 20:30:33.460 +03:00 [INF] User profile is available. Using '/Users/Levent/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2023-11-06 20:30:34.260 +03:00 [INF] Now listening on: https://localhost:7109
2023-11-06 20:30:34.260 +03:00 [INF] Now listening on: http://localhost:5223
2023-11-06 20:30:34.262 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2023-11-06 20:30:34.262 +03:00 [INF] Hosting environment: Development
2023-11-06 20:30:34.262 +03:00 [INF] Content root path: /Users/Levent/Desktop/SanctionScanner/BackEnd/src/SanctionScanner.WebApi
2023-11-06 20:30:42.040 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/index.html - -
2023-11-06 20:30:42.270 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/index.html - - - 200 - text/html;charset=utf-8 232.0619ms
2023-11-06 20:30:42.538 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - -
2023-11-06 20:30:42.771 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7109/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 232.4193ms
2023-11-06 20:31:03.773 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54
2023-11-06 20:31:03.802 +03:00 [INF] CORS policy execution successful.
2023-11-06 20:31:03.941 +03:00 [INF] Executing endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:31:03.977 +03:00 [INF] Route matched with {action = "Return", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Return(Application.Features.Books.Commands.AddBook.BookReturnCommand) on controller WebApi.Controllers.BooksController (SanctionScanner.WebApi).
2023-11-06 20:31:07.345 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [l].[Id], [l].[BookId], [l].[CreatedByUserId], [l].[CreatedOn], [l].[DeletedByUserId], [l].[DeletedOn], [l].[DueDate], [l].[IsDeleted], [l].[LoanDate], [l].[LoanedOutTo], [l].[ModifiedByUserId], [l].[ModifiedOn], [l].[ReturnedDate]
FROM [Loans] AS [l]
WHERE [l].[BookId] = @__request_BookId_0 AND ([l].[ReturnedDate] IS NULL)
2023-11-06 20:31:07.531 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_BookId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[Author], [b].[CreatedByUserId], [b].[CreatedOn], [b].[DeletedByUserId], [b].[DeletedOn], [b].[Genre], [b].[ImageUrl], [b].[IsAvailable], [b].[IsDeleted], [b].[ModifiedByUserId], [b].[ModifiedOn], [b].[Title]
FROM [Books] AS [b]
WHERE [b].[Id] = @__request_BookId_0
2023-11-06 20:31:10.558 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p3='?' (DbType = Guid), @p2='?' (DbType = DateTimeOffset)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [IsAvailable] = @p0
OUTPUT 1
WHERE [Id] = @p1;
UPDATE [Loans] SET [ReturnedDate] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2023-11-06 20:31:20.557 +03:00 [INF] Executing OkObjectResult, writing value of type 'Domain.Common.Response`1[[System.Guid, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2023-11-06 20:31:20.581 +03:00 [INF] Executed action WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi) in 16594.9697ms
2023-11-06 20:31:20.584 +03:00 [INF] Executed endpoint 'WebApi.Controllers.BooksController.Return (SanctionScanner.WebApi)'
2023-11-06 20:31:20.626 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7109/api/Books/A3F71772-A295-4EE6-DC7A-08DBDEDF146B/return application/json 54 - 200 - application/json;+charset=utf-8 16854.1532ms
